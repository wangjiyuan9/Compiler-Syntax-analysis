# Compiler-Syntax-analysis

**一、**    **程序功能描述**

在本实验中，我进行了LL1语法的分析设计和程序实现。首先使用**GrammarProxy**类将文法：

![image-20230513222857451](C:\Users\Wang\AppData\Roaming\Typora\typora-user-images\image-20230513222857451.png)

进行解析，并计算**First**集和**Follow**集： 

![image-20230513222844014](C:\Users\Wang\AppData\Roaming\Typora\typora-user-images\image-20230513222844014.png)

并且完成**LL1**语法分析表。之后，使用**Verification**类解析测试文件的二元式序列，并由之前的分析表格，构造分析栈进行分析。最后，使用**OutPut**类输出文法分析的每个结果（以表格呈现），分析栈的分析过程，以及该算术表达式是否符合文法定义。

本次我的代码较多且经过多次抽象，故尽量以流程图的形式展示，避免繁杂的代码，具体看实现过程请参阅代码包。

**一、**    **主要数据结构**

| **变量名**                       | **类型**                                | **用途**                                                     |
| -------------------------------- | --------------------------------------- | ------------------------------------------------------------ |
| **line**                         | **string**                              | **存储读取的文件中的一行**                                   |
| **BinEpr**                       | **string**                              | **存储读取的文件中的一个二元式**                             |
| **Symbol**                       | **string**                              | **存储读取的文件中的一个符号**                               |
| **LL1table**                     | **map<pair<mark, mark>, vector<mark>>** | **存储**LL1**分析表**                                        |
| **HasAnalyze**                   | **vector<string>**                      | **存储已经分析过的符号**                                     |
| **key**                          | **deque<int>**                          | **存储单词符号的编码类别**                                   |
| **word**                         | **deque<string>**                       | **存储单词符号的字符串**                                     |
| **analyze**                      | **vector<string>**                      | **存储分析过程中的信息**                                     |
| **以上是**Verification**的变量** |                                         |                                                              |
| **N**                            | **int**                                 | **定义常量，表示数组大小**                                   |
| **first**                        | **map<mark,  set<mark>>**               | **存储每个符号的**first**集合**                              |
| **follow**                       | **map<mark, set<mark>>**                | **存储每个符号的**follow**集合**                             |
| **grammars**                     | **map<mark, vector<vector<mark>>>**     | **存储每个非终结符的产生式**                                 |
| **terminal**                     | **set<mark>**                           | **存储终结符**                                               |
| **nonterminal**                  | **set<mark>**                           | **存储非终结符**                                             |
| **LL1table**                     | **map<pair<mark, mark>, vector<mark>>** | **存储**LL1**分析表**                                        |
| **arrow_pos**                    | **int**                                 | **->**的位置**                                               |
| **left_part**                    | **char**                                | **产生式左部第一个字符**                                     |
| **left_symbol**                  | **mark**                                | **产生式左部对应的**mark**值**                               |
| **right_part_str**               | **string**                              | **产生式右部字符串**                                         |
| **right_part_ss**                | **stringstream**                        | **产生式右部字符串流**                                       |
| **right_part**                   | **string**                              | **产生式右部的每一部分**                                     |
| **org_size**                     | **int**                                 | **first**集原大小**                                          |
| **any_change**                   | **bool**                                | **first,follow**集是否发生变化的标志**                       |
| **以上是**Verification**的变量** |                                         |                                                              |
| **Str2Mark**                     | **map<char, mark>**                     | **将字符映射为标识符**                                       |
| **Mark2Str**                     | **map<mark,  string>**                  | **将标识符映射为字符**                                       |
| **PairHash**                     | **struct PairHash**                     | **用于对**pair**类型进行哈希**                               |
| **ENDSYMBOL**                    | **int**                                 | **结束符号的标识符**                                         |
| **EMPTY**                        | **int**                                 | **空串的标识符**                                             |
| 以上是**Charmap**的变量          |                                         |                                                              |
| **grm**                          | **GrammarProxy**                        | **存储文法相关信息，包括产生式、终结符、非终结符、**First**集、**Follow**集、**LL1**分析表等** |
| **vrf**                          | **Verification**                        | **存储测试文件相关信息，包括测试用例、符号等**               |
| **filename**                     | **string**                              | **存储文件名**                                               |
| **analyze_result**               | **vector<string>**                      | **存储**LL1**语法分析过程信息**                              |
| **out**                          | **OutPut**                              | **存储输出相关信息，包括文法解析、**LL1**分析表、分析过程的字符串等** |
| 以上是**Main**的变量             |                                         |                                                              |

 

表2.1 **LL1**分析程序**变量定义表

此次程序比较复杂，总体包括五个CPP函数，出现了3个类，以上罗列的并不全，但是重要的变量都写清楚了。

**二、**    **程序结构描述**

**（1）** **设计方法**

在完成众多标识命名时，我使用了之前的部分表示规则，也新增了一些规则，写在了**底层Charmap函数中，**罗列如下：

| **符号类型** | **标识** | **符号类型** | **标识** | **符号类型** | **标识** |
| ------------ | -------- | ------------ | -------- | ------------ | -------- |
| **标识符**   | **1**    | **空串**     | **2**    | **终止符号** | **3**    |
| **;**        | **19**   | **,**        | **20**   | **{**        | **21**   |
| **}**        | **22**   | **[**        | **23**   | **]**        | **24**   |
| **(**        | **25**   | **)**        | **26**   | **%**        | **27**   |
| **+**        | **28**   | **-**        | **29**   | ***          | **30**   |
| **/**        | **31**   | **=**        | **32**   | **<**        | **33**   |
| **>**        | **34**   | **&**        | **35**   | **\|**       | **36**   |
| **!**        | **37**   | **S**        | **100**  | **E**        | **101**  |
| **D**        | **102**  | **T**        | **103**  | **U**        | **104**  |
| **F**        | **105**  | **A**        | **106**  | **M**        | **107**  |

表3.1 LL1语法符号类型定义表

**在这里，我主要分析，文法解析、**First**集、**Follow**集、**LL1**分析表计算，**LL1**分析栈分析过程的流程，输出类（但我花了最多的时间在这一部分才完成了整齐的表格效果，里面有许多的表格输出对齐）和底层定义不做赘述。**

·
